<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favorites - NexGenMusic</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --primary: #1B5E20; --primary-light: #2E7D32; --accent: #4CAF50; --bg: #F5F7F5; --white: #FFFFFF; --text: #1A1A1A; --text-secondary: #6B7280; --text-muted: #9CA3AF; --border: #E5E7EB; --radius: 12px; --radius-lg: 16px; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        .app { display: flex; min-height: 100vh; }
        .sidebar { width: 260px; background: var(--white); border-right: 1px solid var(--border); position: fixed; height: 100vh; display: flex; flex-direction: column; }
        .sidebar-header { padding: 24px 20px; border-bottom: 1px solid #F0F0F0; }
        .logo { display: flex; align-items: center; gap: 12px; text-decoration: none; color: var(--text); }
        .logo-icon { width: 40px; height: 40px; background: var(--primary); border-radius: var(--radius); display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; }
        .logo-text { font-size: 18px; font-weight: 700; }
        .sidebar-nav { flex: 1; padding: 16px 12px; overflow-y: auto; }
        .nav-section { margin-bottom: 24px; }
        .nav-title { font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; padding: 0 12px; margin-bottom: 8px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 14px; border-radius: var(--radius); color: var(--text-secondary); text-decoration: none; font-size: 14px; font-weight: 500; transition: all 0.2s; margin-bottom: 4px; }
        .nav-item:hover { background: #F0FDF4; color: var(--primary); }
        .nav-item.active { background: var(--primary); color: white; }
        .nav-item svg { width: 20px; height: 20px; stroke: currentColor; }
        .mobile-promo { margin: 12px; padding: 20px; background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); border-radius: var(--radius-lg); color: white; }
        .mobile-promo h4 { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
        .mobile-promo p { font-size: 12px; opacity: 0.9; margin-bottom: 12px; }
        .promo-btn { display: inline-block; background: white; color: var(--primary); padding: 8px 16px; border-radius: 8px; font-size: 12px; font-weight: 600; text-decoration: none; }
        .main-wrapper { flex: 1; margin-left: 260px; display: flex; flex-direction: column; min-height: 100vh; }
        .header { background: var(--white); border-bottom: 1px solid var(--border); padding: 16px 32px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 50; }
        .search-box { display: flex; align-items: center; gap: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); padding: 10px 16px; width: 320px; }
        .search-box input { flex: 1; border: none; background: transparent; font-size: 14px; outline: none; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), var(--accent)); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; cursor: pointer; }
        .main-content { flex: 1; padding: 32px; overflow-y: auto; }
        .page-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 32px; }
        .page-title { font-size: 28px; font-weight: 700; }
        .page-subtitle { font-size: 14px; color: var(--text-secondary); margin-top: 4px; }
        .card { background: white; border-radius: var(--radius-lg); border: 1px solid var(--border); overflow: hidden; margin-bottom: 24px; }
        .card-header { display: flex; align-items: center; justify-content: space-between; padding: 20px 24px; border-bottom: 1px solid #F0F0F0; }
        .card-title { font-size: 16px; font-weight: 600; }
        .card-body { padding: 24px; }
        .track-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .track-card { background: var(--bg); border-radius: var(--radius); padding: 16px; transition: all 0.2s; cursor: pointer; }
        .track-card:hover { background: #F0FDF4; transform: translateY(-2px); }
        .track-cover { width: 100%; aspect-ratio: 1; border-radius: var(--radius); background: linear-gradient(135deg, var(--primary), var(--accent)); display: flex; align-items: center; justify-content: center; color: white; font-size: 48px; margin-bottom: 12px; }
        .track-name { font-size: 15px; font-weight: 600; margin-bottom: 4px; }
        .track-artist { font-size: 13px; color: var(--text-secondary); margin-bottom: 12px; }
        .track-actions { display: flex; gap: 8px; }
        .track-btn { flex: 1; padding: 8px; border-radius: 8px; border: 1px solid var(--border); background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); font-size: 12px; gap: 4px; }
        .track-btn:hover { border-color: var(--primary); color: var(--primary); }
        .track-btn.play { background: var(--primary); border-color: var(--primary); color: white; }
        .empty-state { text-align: center; padding: 48px 24px; }
        .empty-icon { width: 80px; height: 80px; background: #F0FDF4; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: var(--primary); font-size: 32px; }
        .empty-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; }
        .empty-text { font-size: 14px; color: var(--text-secondary); }
        @media (max-width: 1024px) { .sidebar { display: none; } .main-wrapper { margin-left: 0; } }
        @media (max-width: 768px) { .track-grid { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body>
<div class="app">
    <aside class="sidebar">
        <div class="sidebar-header"><a href="/dashboard/" class="logo"><div class="logo-icon">‚ô™</div><span class="logo-text">NexGenMusic</span></a></div>
        <nav class="sidebar-nav">
            <div class="nav-section"><div class="nav-title">Menu</div>
                <a href="/dashboard/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6z"/></svg>Dashboard</a>
                <a href="/ai-generator/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/></svg>AI Generator</a>
                <a href="/spotify-recommendations/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"/></svg>Spotify</a>
                <a href="/history/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>History</a>
            </div>
            <div class="nav-section"><div class="nav-title">Library</div>
                <a href="/library/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"/></svg>My Library</a>
                <a href="/library/favorites/" class="nav-item active"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"/></svg>Favorites</a>
                <a href="/library/playlists/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"/></svg>Playlists</a>
            </div>
            <div class="nav-section"><div class="nav-title">General</div>
                <a href="/settings/" class="nav-item"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>Settings</a>
                <a href="#" class="nav-item" onclick="logout(); return false;"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"/></svg>Logout</a>
            </div>
        </nav>
        <div class="mobile-promo" style="background: linear-gradient(135deg, #0D3B12 0%, #1B5E20 100%);"><h4>üì∏ Connect on Instagram</h4><p>Follow for updates & more</p><a href="https://instagram.com/nish.1__" target="_blank" class="promo-btn" style="color: #1B5E20;">Follow @nish.1__</a></div>
    </aside>
    <div class="main-wrapper">
        <header class="header">
            <div class="search-box"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width:18px;height:18px;color:#9CA3AF"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/></svg><input type="text" placeholder="Search favorites..."></div>
            <div class="user-avatar" id="userAvatar" onclick="window.location.href='/profile/'">U</div>
        </header>
        <main class="main-content">
            <div class="page-header"><div><h1 class="page-title">Favorites</h1><p class="page-subtitle">Your liked tracks and saved music.</p></div></div>
            <div class="card">
                <div class="card-header"><h3 class="card-title">‚ù§Ô∏è Liked Tracks</h3><span id="favCount" style="font-size: 14px; color: var(--text-secondary);">0 tracks</span></div>
                <div class="card-body">
                    <div class="track-grid" id="favoritesGrid">
                        <!-- Favorites will be loaded dynamically -->
                    </div>
                    <div id="emptyState" style="text-align: center; padding: 48px; color: var(--text-secondary); display: none;">
                        <div style="font-size: 48px; margin-bottom: 16px;">üíî</div>
                        <h3 style="margin-bottom: 8px;">No favorites yet</h3>
                        <p>Like tracks from AI Generator or Spotify to see them here!</p>
                        <a href="/ai-generator/" class="btn-primary" style="display: inline-block; margin-top: 16px; text-decoration: none;">Create Music</a>
                    </div>
                </div>
            </div>

            <!-- Playlists Section -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header"><h3 class="card-title">üìÅ Your Playlists</h3><button class="btn-outline" onclick="createNewPlaylist()" style="padding: 8px 16px; font-size: 13px;">+ New Playlist</button></div>
                <div class="card-body">
                    <div class="playlist-grid" id="playlistsGrid">
                        <!-- Playlists will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<style>
    .playlist-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 16px; }
    .playlist-card { background: var(--bg); border-radius: var(--radius); padding: 20px; cursor: pointer; transition: all 0.2s; }
    .playlist-card:hover { background: #E8F5E9; transform: translateY(-2px); }
    .playlist-icon { font-size: 32px; margin-bottom: 12px; }
    .playlist-name { font-weight: 600; margin-bottom: 4px; }
    .playlist-count { font-size: 13px; color: var(--text-secondary); }
    .remove-btn { background: #FEE2E2; color: #EF4444; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 8px; }
    .remove-btn:hover { background: #EF4444; color: white; }
</style>
<script>
function loadFavorites() {
    const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    const grid = document.getElementById('favoritesGrid');
    const emptyState = document.getElementById('emptyState');
    const countEl = document.getElementById('favCount');
    
    countEl.textContent = `${favorites.length} tracks`;
    
    if (favorites.length === 0) {
        grid.innerHTML = '';
        emptyState.style.display = 'block';
        return;
    }
    
    emptyState.style.display = 'none';
    grid.innerHTML = favorites.map(fav => `
        <div class="track-card">
            <div class="track-cover">${fav.type === 'spotify' ? 'üéß' : 'üéµ'}</div>
            <div class="track-name">${fav.title}</div>
            <div class="track-artist">${fav.type === 'spotify' ? 'Spotify' : 'AI Generated'}${fav.mood ? ' ‚Ä¢ ' + fav.mood : ''}</div>
            <div class="track-actions">
                <button class="track-btn play">‚ñ∂ Play</button>
                <button class="track-btn" onclick="removeFavorite(${fav.id})" style="color: #EF4444;">üóëÔ∏è</button>
            </div>
        </div>
    `).join('');
}

function removeFavorite(id) {
    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    favorites = favorites.filter(f => f.id !== id);
    localStorage.setItem('favorites', JSON.stringify(favorites));
    loadFavorites();
}

function loadPlaylists() {
    let playlists = JSON.parse(localStorage.getItem('playlists') || '[]');
    const grid = document.getElementById('playlistsGrid');
    
    if (playlists.length === 0) {
        playlists = [{ id: 1, name: 'My Favorites', tracks: [] }, { id: 2, name: 'Chill Vibes', tracks: [] }];
        localStorage.setItem('playlists', JSON.stringify(playlists));
    }
    
    grid.innerHTML = playlists.map(p => `
        <div class="playlist-card" onclick="viewPlaylist(${p.id})">
            <div class="playlist-icon">üìÅ</div>
            <div class="playlist-name">${p.name}</div>
            <div class="playlist-count">${p.tracks.length} tracks</div>
            <button class="remove-btn" onclick="event.stopPropagation(); removePlaylist(${p.id})">Delete</button>
        </div>
    `).join('');
}

function createNewPlaylist() {
    const name = prompt('Enter playlist name:');
    if (!name) return;
    let playlists = JSON.parse(localStorage.getItem('playlists') || '[]');
    playlists.push({ id: Date.now(), name: name, tracks: [] });
    localStorage.setItem('playlists', JSON.stringify(playlists));
    loadPlaylists();
}

function removePlaylist(id) {
    if (!confirm('Delete this playlist?')) return;
    let playlists = JSON.parse(localStorage.getItem('playlists') || '[]');
    playlists = playlists.filter(p => p.id !== id);
    localStorage.setItem('playlists', JSON.stringify(playlists));
    loadPlaylists();
}

function viewPlaylist(id) {
    const playlists = JSON.parse(localStorage.getItem('playlists') || '[]');
    const playlist = playlists.find(p => p.id === id);
    if (playlist) {
        alert(`Playlist: ${playlist.name}\nTracks: ${playlist.tracks.length}\n\n${playlist.tracks.map(t => '‚Ä¢ ' + t.title).join('\n') || 'No tracks yet'}`);
    }
}

function logout() { 
    if (confirm('Are you sure you want to logout?')) {
        // Only remove session tokens, keep user data
        localStorage.removeItem('access_token');
        localStorage.removeItem('refresh_token');
        localStorage.removeItem('token');
        window.location.href = '/'; 
    }
}

// Load user profile
function loadUserProfile() {
    const userData = JSON.parse(localStorage.getItem('userData') || '{}');
    const userAvatar = localStorage.getItem('userAvatar');
    const avatarEl = document.getElementById('userAvatar');
    
    if (avatarEl && userData.username) {
        if (userAvatar) {
            avatarEl.style.backgroundImage = `url(${userAvatar})`;
            avatarEl.style.backgroundSize = 'cover';
            avatarEl.style.backgroundPosition = 'center';
            avatarEl.textContent = '';
        } else {
            avatarEl.textContent = userData.username.charAt(0).toUpperCase();
        }
    }
}

// Load on page load
document.addEventListener('DOMContentLoaded', () => { loadFavorites(); loadPlaylists(); loadUserProfile(); });
</script>
</body>
</html>